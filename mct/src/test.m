
clear

M = ones(); %rand(4, 4);
M2 = M .* (1 - eye(4));

Q1 = M2 - diag(sum(M2, 2))

Q2 =  [ -1.088     0.8548     0.1605    0.07264
    0.3002     -1.214     0.6288     0.2845
    0.1577     0.3485     -1.482     0.9758
   0.09365      0.207     0.9574     -1.258 ];

Q = Q2;

t = 0.4532;

i = 1;

[Qevec, Qeval] = eig(Q);

Qevec * Qeval * inv(Qevec);

eval_ = diag(Qeval)

QevecI = inv(Qevec);

scaled = exp(diag(Qeval)*t);
scaled = scaled .* Qevec(i, :)';
prob_vec = QevecI' * scaled

sum(prob_vec)

res1 = Qevec * diag(exp(diag(Qeval)*t)) * QevecI;
res = expm(Q*t);

pi =[ 0.04875     0.0748    0.07648     0.0817    0.08708    0.09069 ...
    0.09126    0.08813     0.0813    0.07144    0.05966    0.04725   ...
 0.03544    0.02514    0.01684    0.01064   0.006336   0.003548  ...
 0.001867  0.0009212  0.0004256  0.0001838  7.401e-05  2.773e-05  ...
9.641e-06  3.102e-06  9.201e-07  2.507e-07  6.246e-08  1.416e-08  ...
2.901e-09  5.336e-10  8.731e-11  1.257e-11  1.571e-12  1.675e-13  ...
1.487e-14  1.051e-15  4.546e-17  -8.64e-18 ];

pi = [ 0.04875     0.0748    0.07648     0.0817    0.08708    0.09069    0.09126    0.08813     0.0813    0.07144    0.05966    0.04725    0.03544    0.02514    0.01684    0.01064   0.006336   0.003548   0.001867  0.0009212  0.0004256  0.0001838  7.401e-05  2.773e-05  9.641e-06  3.102e-06  9.201e-07  2.507e-07  6.246e-08  1.416e-08  2.901e-09  5.336e-10  8.731e-11  1.257e-11  1.543e-12 ];


%pi = [0.0005412   0.001151   0.002078   0.003506    0.00567   0.008846    0.01332    0.01936    0.02711     0.0365    0.04718    0.05846    0.06932    0.07855    0.08494    0.08756    0.08594    0.08025    0.07125    0.06011    0.04817    0.03667    0.02651    0.01822     0.0119   0.007393   0.004373   0.002466   0.001326  0.0006817  0.0003352   0.000158  7.144e-05  3.106e-05    1.3e-05  5.245e-06  2.037e-06  7.566e-07  2.623e-07  7.713e-08];

plot(pi);